<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>{{ curso.title }} - SouffleApp</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <style>
        body {
            background: linear-gradient(135deg, #ff97d9 0%, #ffc1ff 100%);
            min-height: 100vh;
        }
        .btn-rosa {
            background-color: #C93384;
            color: #fff;
            border: none;
        }
        .btn-rosa:hover, .btn-rosa:focus {
            background-color: #a82a6a;
            color: #fff;
        }
        .btn-rosa-claro {
            background-color: #ff97d9;
            color: #C93384;
            border: none;
        }
        .btn-rosa-claro:hover, .btn-rosa-claro:focus {
            background-color: #ffc1ff;
            color: #C93384;
        }
        .curso-title {
            color: #C93384;
            letter-spacing: 1px;
            font-size: 3.2rem;
            font-weight: bold;
            margin-bottom: 2rem;
        }
        .curso-img {
            max-height: 340px;
            object-fit: cover;
            box-shadow: 0 4px 24px #fcb0ea55;
            background: #fff0f6;
            border-radius: 1.2rem;
        }
        .favorite-btn {
            margin-top: 1rem;
            width: 100%;
            background: #fff0f6;
            color: #C93384;
            border-radius: 1rem;
            font-weight: 600;
            border: 1px solid #f4a8d8;
            transition: transform 0.2s, background 0.2s, color 0.2s;
        }
        .favorite-btn:hover {
            transform: scale(1.03);
            background: #e44f9c;
            color: #fff;
        }
        .favorite-btn-active {
            background: #e44f9c;
            color: #fff;
        }
        .favorite-btn-active:hover {
            background: #c93384;
        }
    </style>
</head>
{% include 'souffleApp/whatsapp_button.html' %}
<body>
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10 col-lg-8">
                <div class="card shadow-lg p-4" style="border-radius: 1.5em; background: rgba(255,255,255,0.93);">
                    <h1 class="curso-title text-center w-100">{{ curso.title }}</h1>
                    <div class="row align-items-start mt-4">
                        <div class="col-12 col-md-4 d-flex flex-column align-items-center mb-3 mb-md-0">
                            <img src="{{ curso.image.url }}" alt="{{ curso.title }}" class="img-fluid curso-img mb-3">
                            <button class="btn btn-rosa w-100" type="button" onclick="document.getElementById('horarios-box').style.display='block'">Ver Horarios</button>
                            {% if user.is_authenticated %}
                            <form method="post" action="{% url 'toggle_favorite' curso.id %}" class="w-100">
                                {% csrf_token %}
                                <input type="hidden" name="next" value="{{ request.get_full_path }}">
                                {% if is_favorite %}
                                <button type="submit" class="btn favorite-btn favorite-btn-active">En favoritos</button>
                                {% else %}
                                <button type="submit" class="btn favorite-btn">Añadir a favoritos</button>
                                {% endif %}
                            </form>
                            {% else %}
                            <a class="btn favorite-btn w-100" href="{% url 'login' %}?next={{ request.get_full_path|urlencode }}">Añadir a favoritos</a>
                            {% endif %}
                            <div id="compra-exitosa" style="display:none;" class="alert alert-success text-center mt-2">¡Compra exitosa!</div>
                            <div id="horarios-box" style="display:none; margin-top:1em; width:100%;">
                                <h4 class="text-center">Horarios disponibles</h4>
                                <ul class="list-group mb-3">
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <span>10/09/2025 - 10:00 AM</span>
                                        <span>Cupos: 5</span>
                                        <button class="btn btn-rosa-claro btn-sm ms-2" onclick="mostrarCompraExitosa()">Comprar</button>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <span>12/09/2025 - 4:00 PM</span>
                                        <span>Cupos: 3</span>
                                        <button class="btn btn-rosa-claro btn-sm ms-2" onclick="mostrarCompraExitosa()">Comprar</button>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <span>15/09/2025 - 7:00 PM</span>
                                        <span>Cupos: 2</span>
                                        <button class="btn btn-rosa-claro btn-sm ms-2" onclick="mostrarCompraExitosa()">Comprar</button>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-12 col-md-8">
                            <p><strong>Descripción:</strong><br>{{ curso.long_description|linebreaks }}</p>
                            <p><strong>Duración:</strong><br>{{ curso.duration|linebreaks }}</p>
                            <p><strong>Resultados de aprendizaje:</strong><br>{{ curso.learning_outcomes|linebreaks }}</p>
                            <p><strong>Materiales:</strong><br>{{ curso.materials|linebreaks }}</p>
                            <p><strong>Ingredientes:</strong><br>{{ curso.ingredients|linebreaks }}</p>
                            <p><strong>Precio:</strong><br>{{ curso.price|linebreaks }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
<script>
function mostrarCompraExitosa() {
    var mensaje = document.getElementById('compra-exitosa');
    mensaje.style.display = 'block';
    setTimeout(function() {
        mensaje.style.display = 'none';
    }, 2500);
}
</script>
</body>
</html>